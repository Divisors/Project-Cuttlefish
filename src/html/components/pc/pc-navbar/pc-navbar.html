<link rel="import" href="/components/polymer/polymer.html"/>
<pc-loader target='["paper-button"]'></pc-loader>
<dom-module id="pc-navbar">
	<link rel="import" type="css" href="pc-navbar.css"/>
	<link rel="import" type="css" href="/css/component-transitions.css"/>
	<template>
		<div class="navbar-header mh50">
			<span class="navbar-menu-button mh50"><content select=".navbar-header-item"></content></span>
			<paper-button class="navbar-brand mh50" href="#">{{brand}}</paper-button>
		</div>
		<div class="navbar-titlebar">
			{{title}}
		</div>
		<ul id="navbar-itemlist">
			<paper-button href="#assignments" name="assignments">Assignments</paper-button>
			<paper-button href="#schedule" name="schedule">Schedule</paper-button>
			<paper-button href="#clubs" name="clubs">Clubs</paper-button>
			<paper-button href="#grades" name="grades">Grades</paper-button>
		</ul>
		<ul id="navbar-right" class=" transitions in-fade-in out-fade-out">
			<li>Username <iron-icon icon="icons:arrow-drop-down"></iron-icon></li>
		</ul>
		<div id="shadow"></div>
	</template>
	<script>
		Polymer({
			is: 'pc-navbar',
			properties: {
				mobile: {
					type: Boolean,
					readOnly: true
				},
				brand: {
					type: String
				},
				title: {
					type: String
				}
			},
			ready: function() {
				window.navbar=this;
				this.scopeSubtree(this.$$('#navbar-itemlist'), true);
				var self = this;
				$(this).find('paper-button[href]')
					.addClass('transitions out-slide-down in-slide-up')
					.on('click',function(e) {
						window.location = $(e.target).attr('href');
						self.setActiveButton($(e.target).attr('name'));
					});
			},
			setActiveButton: function(name) {
				var buttons = $(this).find('#navbar-itemlist > paper-button');
				buttons.filter('.hash-active').removeClass('hash-active');
				buttons.filter('[name='+name+']').addClass('hash-active');
			},
			getButtons: function() {
				return $(this).find('#navbar-itemlist>paper-button');
			},
			disable: function(i) {
				var buttons = this.getButtons();
				var num = (i !== undefined) ? i : buttons.length;
				if (num < 0) {
					$(this).find('.navbar-right').addClass('transitioning');
					return;
				}
				$(buttons[num]).addClass('transitioning');
				setTimeout(this.disable.bind(this, num - 1), 100);
			},
			disableFast() {
				this.getButtons().addClass('transitioning');
				$(this).find('#navbar-right').addClass('transitioning');
			},
			enable: function(i) {
				var num = i || 0;
				var buttons = this.getButtons();
				if (num >= buttons.length) {
					$(this).find('#navbar-right').removeClass('transitioning');
					return;
				}
				$(buttons[num]).removeClass('transitioning');
				setTimeout(this.enable.bind(this, num + 1), 100);
			},
			enableFast() {
				this.getButtons().removeClass('transitioning');
			}
		});
	</script>
</dom-module>